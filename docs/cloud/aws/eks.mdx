---
title: Assess an AWS EKS Cluster
sidebar_label: Assess an AWS EKS Cluster
displayed_sidebar: cnspec
sidebar_position: 40
description: Assess the security and compliance of an AWS EKS cluster
image: /img/cnspec/mondoo-aws.jpg
---

Now that you have an introduction to [assessing your AWS account](/cnspec/cloud/aws/account/) with cnspec and have tried an [EC2 test](/cnspec/cloud/aws/ec2), let's dive deeper and test EKS clusters.

## Scan EKS clusters

To scan your EKS clusters against security policies:

```bash
cnspec scan aws --discover eks-clusters
```

To scan EKS clusters in a specific region:

```bash
cnspec scan aws --discover eks-clusters --region us-west-2
```

## Explore EKS in the cnspec shell

We'll continue working in the cnspec shell, which makes running individual queries easy. If it's not already open, enter `cnspec shell aws` in your terminal. To learn about accessing your AWS account with cnspec, read [Assess AWS Security](/cnspec/cloud/aws/).

## EKS resources

cnspec provides answers to any question about your EKS clusters. To discover all the resources and fields you can query, read [aws.eks](/mql/resources/aws#aws.eks). You can also use the `help` command in the shell:

```bash
help aws.eks
```

## Run a simple test on EKS clusters

This test ensures that all EKS clusters use encryption:

```bash
aws.eks.clusters.all( encryptionConfig != null )
```

If the test passes (all EKS clusters use encryption) then cnspec returns `ok`:

```coffeescript
[ok] value: true`
```

If the test fails (one or more EKS clusters do not use encryption) then cnspec provides details about the failure:

```coffeescript
[failed] [].all()
  actual:   [
    0: aws.ec2.instance id = arn:aws:ec2:us-east-1:177043751234:instance/i-0fde6c8e0210b7i26
    1: aws.ec2.instance id = arn:aws:ec2:us-east-1:177043751234:instance/i-01d9ac4d064722qa4
  ]
```

## Learn more about querying EKS clusters

- To learn more about how the MQL query language works, read [Write Effective MQL](/mql/mql-write).
- For a list of all the AWS resources and fields you can query, read the [Mondoo Amazon Web Services (AWS) Resource Pack Reference](/mql/resources/aws/).
- For a list of all the Kubernetes resources and fields you can query, read the [Mondoo Kubernetes (K8s) Resource Pack Reference](/mql/resources/k8s/).

---
