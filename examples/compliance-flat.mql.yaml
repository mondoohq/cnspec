frameworks:
  - uid: lunalectric-soc2-framework
    name: SOC 2 (Lunalectric)
    groups:
      - uid: soc2-group-cc6-1
        title: CC6.1 - The entity implements logical access security software, infrastructure, and architectures over protected information assets to protect them from security events to meet the entityâ€™s objectives
        controls:
          - uid: soc2-control-cc6-1-11
            title: 'CC6.1.11: Protects Cryptographic Keys'
            docs:
              desc: The entity protects cryptographic keys during generation, storage, use, and destruction. Cryptographic modules, algorithms, key lengths, and architectures are appropriate based on the entity's risk mitigation strategy.
            evidence:
              - title: Protect cryptographic keys in SSH
                checks:
                  - uid: ssh-strong-ciphers
                    title: Use strong ciphers in SSH
                    filters: asset.family.contains('linux')
                    mql: sshd.config.ciphers.all( _ == /ctr/i )
                  - uid: ssh-set-protocol-to-2
                    title: Set the SSH protocol to 2
                    filters: asset.family.contains('linux')
                    mql: sshd.config.params.Protocol == 2
                queries:
                  - uid: ssh-config-params
                    title: Collect the SSH configuration
                    filters: asset.family.contains('linux')
                    mql: sshd.config.blocks{*}
                  - uid: ssh-config-location
                    title: Collect the location of the SSH configuration
                    filters: asset.family.contains('linux')
                    mql: sshd.config.files{path}

# BEHIND THE SCENES ....

# ==> generates 3 distinct objects:
#   - Framework          (lunalectric-soc2-framework)
#   - Policy             (lunalectric-soc2-framework-policy)
#   - Framework Mappings (lunalectric-soc2-framework-map)

