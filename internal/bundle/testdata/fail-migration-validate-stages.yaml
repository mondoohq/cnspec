policies:
- uid: ubuntu-bench-1
  name: Ubuntu Benchmark 1
  version: 1.0.0
  tags:
    mondoo.com/category: compliance
    mondoo.com/platform: ubuntu:24.04,linux
  require:
  - provider: os
  authors:
  - name: Mondoo, Inc.
    email: hello@mondoo.com
  docs:
    desc: test description
  groups:
  - uid: ubuntu-1
    title: Configure Ubuntu 1
    filters: |
      asset.platform == "ubuntu"
      asset.version == "24.04"
      asset.kind != "container-image"
      asset.runtime != "docker-container"
    checks:
    - uid: ubuntu-1-1
    - uid: ubuntu-1-2
  - uid: ubuntu-2
    title: Configure Ubuntu 2
    filters: |
      asset.platform == "ubuntu"
      asset.version == "24.04"
      asset.kind != "container-image"
    checks:
    - uid: ubuntu-2-1
    - uid: ubuntu-2-2
  scoring_system: highest impact
- uid: ubuntu-bench-2
  name: Ubuntu Benchmark 2
  version: 1.0.0
  tags:
    mondoo.com/category: compliance
    mondoo.com/platform: ubuntu:24.04,linux
  require:
  - provider: os
  authors:
  - name: Mondoo, Inc.
    email: hello@mondoo.com
  docs:
    desc: test description
  groups:
  - uid: ubuntu-hard-1
    title: Configure Ubuntu 1
    filters: |
      asset.platform == "ubuntu"
      asset.version == "24.04"
      asset.kind != "container-image"
      asset.runtime != "docker-container"
    checks:
    - uid: ubuntu-hard-1-1
    - uid: ubuntu-hard-1-2
  - uid: ubuntu-hard-2
    title: Configure Ubuntu 2
    filters: |
      asset.platform == "ubuntu"
      asset.version == "24.04"
      asset.kind != "container-image"
    checks:
    - uid: ubuntu-hard-2-1
    - uid: ubuntu-hard-2-2
  scoring_system: highest impact
queries:
- uid: ubuntu-1-1
  title: Test Ubuntu 1-1
  impact: 30
  tags:
    test/tag: "1.1"
  mql: |
    file("/etc/passwd").exists
  docs:
    desc: test_description
    audit: test_description
    remediation:
    - id: terraform
      desc: |
        test-description
    - id: ansible
      desc: |
        test-description
- uid: ubuntu-1-2
  title: Test Ubuntu 1-2
  impact: 30
  tags:
    test/tag: "1.2"
  mql: |
    file("/etc/passwd").exists
  docs:
    desc: test_description
    audit: test_description
    remediation:
    - id: terraform
      desc: |
        test-description
    - id: ansible
      desc: |
        test-description
- uid: ubuntu-2-1
  title: Test Ubuntu 2-1
  impact: 30
  tags:
    test/tag: "2.1"
  mql: |
    file("/etc/passwd").exists
  docs:
    desc: test_description
    audit: test_description
    remediation:
    - id: terraform
      desc: |
        test-description
    - id: ansible
      desc: |
        test-description
- uid: ubuntu-2-2
  title: Test Ubuntu 2-2
  impact: 30
  tags:
    test/tag: "2.2"
  mql: |
    file("/etc/passwd").exists
  docs:
    desc: test_description
    audit: test_description
    remediation:
    - id: terraform
      desc: |
        test-description
    - id: ansible
      desc: |
        test-description
- uid: ubuntu-hard-1-1
  title: Test Hard Ubuntu 1-1
  impact: 30
  tags:
    test/tag: hard-1.1
  mql: |
    file("/etc/passwd").exists
  docs:
    desc: test_description
    audit: test_description
    remediation:
    - id: terraform
      desc: |
        test-description
    - id: ansible
      desc: |
        test-description
- uid: ubuntu-hard-1-2
  title: Test Hard Ubuntu 1-2
  impact: 30
  tags:
    test/tag: hard-1.2
  mql: |
    file("/etc/passwd").exists
  docs:
    desc: test_description
    audit: test_description
    remediation:
    - id: terraform
      desc: |
        test-description
    - id: ansible
      desc: |
        test-description
- uid: ubuntu-hard-2-1
  title: Test Hard Ubuntu 2-1
  impact: 30
  tags:
    test/tag: hard-2-1
  mql: |
    file("/etc/passwd").exists
  docs:
    desc: test_description
    audit: test_description
    remediation:
    - id: terraform
      desc: |
        test-description
    - id: ansible
      desc: |
        test-description
- uid: ubuntu-hard-2-2
  title: Test Hard Ubuntu 2-2
  impact: 30
  tags:
    test/tag: hard-2-2
  mql: |
    file("/etc/passwd").exists
  docs:
    desc: test_description
    audit: test_description
    remediation:
    - id: terraform
      desc: |
        test-description
    - id: ansible
      desc: test-description
migration_groups:
- stages:
  - title: Stage 1
    migrations:
    # test consumes same query twice
    - action: REMOVE
      source:
        uid: ubuntu-1-1
    - action: MODIFY
      source:
        uid: ubuntu-1-1
      destination:
        uid: ubuntu-1-1-temp
    # test produces same query twice
    - action: MODIFY
      source:
        uid: ubuntu-2-1
      destination:
        uid: ubuntu-2-1-temp
    - action: MODIFY
      source:
        uid: ubuntu-2-2
      destination:
        uid: ubuntu-2-1-temp
    # test rename/swap in the same stage
    - action: MODIFY
      source:
        uid: ubuntu-1-2
      destination:
        uid: ubuntu-hard-1-2
    - action: MODIFY
      source:
        uid: ubuntu-hard-1-2
      destination:
        uid: ubuntu-1-2
